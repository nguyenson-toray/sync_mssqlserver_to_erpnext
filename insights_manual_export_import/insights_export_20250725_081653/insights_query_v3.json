[
  {
    "name": "djb82mf5p9",
    "docstatus": 0,
    "title": null,
    "workbook": "12",
    "use_live_connection": 1,
    "is_script_query": 0,
    "is_builder_query": 0,
    "is_native_query": 0,
    "operations": "[\n {\n  \"table\": {\n   \"query_name\": \"d54efu19h7\",\n   \"type\": \"query\",\n   \"workbook\": \"\"\n  },\n  \"type\": \"source\"\n },\n {\n  \"filters\": [\n   {\n    \"column\": {\n     \"column_name\": \"line\",\n     \"type\": \"column\"\n    },\n    \"operator\": \"=\",\n    \"value\": 1\n   }\n  ],\n  \"logical_operator\": \"And\",\n  \"type\": \"filter_group\"\n },\n {\n  \"dimensions\": [\n   {\n    \"column_name\": \"process_viet\",\n    \"data_type\": \"String\",\n    \"dimension_name\": \"process_viet\",\n    \"label\": \"process_viet\",\n    \"value\": \"process_viet\"\n   }\n  ],\n  \"measures\": [\n   {\n    \"aggregation\": \"sum\",\n    \"column_name\": \"total_qty_ok\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"S\\u1ed1 l\\u01b0\\u1ee3ng \\u0111\\u1ea1t\"\n   },\n   {\n    \"aggregation\": \"sum\",\n    \"column_name\": \"qty_ng\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"S\\u1ed1 l\\u01b0\\u1ee3ng l\\u1ed7i\"\n   },\n   {\n    \"aggregation\": \"avg\",\n    \"column_name\": \"defect_ratio\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"T\\u1ec9 l\\u1ec7 l\\u1ed7i\"\n   }\n  ],\n  \"type\": \"summarize\"\n },\n {\n  \"limit\": 100,\n  \"type\": \"limit\"\n }\n]",
    "linked_queries": "[\n \"d54efu19h7\"\n]",
    "old_name": null,
    "doctype": "Insights Query v3",
    "variables": [],
    "read_only": false
  },
  {
    "name": "d54efu19h7",
    "docstatus": 0,
    "title": "T58_InLineData_sum_by_group",
    "workbook": "12",
    "use_live_connection": 1,
    "is_script_query": 0,
    "is_builder_query": 0,
    "is_native_query": 1,
    "operations": "[\n {\n  \"data_source\": \"Site DB\",\n  \"raw_sql\": \"SELECT \\n    t58.line,                                    -- M\\u00e3 d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n    DATE(t58.date) as production_date,          -- Ng\\u00e0y s\\u1ea3n xu\\u1ea5t (ch\\u1ec9 l\\u1ea5y ph\\u1ea7n date, b\\u1ecf time)\\n    t58.process_no,                             -- M\\u00e3 s\\u1ed1 quy tr\\u00ecnh s\\u1ea3n xu\\u1ea5t\\n    t59.process_viet,                           -- T\\u00ean quy tr\\u00ecnh b\\u1eb1ng ti\\u1ebfng Vi\\u1ec7t (t\\u1eeb b\\u1ea3ng T59_TransInLine)\\n    t59.process_jpn,                            -- T\\u00ean quy tr\\u00ecnh b\\u1eb1ng ti\\u1ebfng Nh\\u1eadt (t\\u1eeb b\\u1ea3ng T59_TransInLine)\\n    \\n    SUM(t58.qty) as total_qty,                  -- T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u01b0\\u1ee3c ki\\u1ec3m tra\\n    SUM(t58.qty_ok) as total_qty_ok,            -- T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u1ea1t ch\\u1ea5t l\\u01b0\\u1ee3ng\\n    \\n    -- T\\u00ednh s\\u1ed1 l\\u01b0\\u1ee3ng kh\\u00f4ng \\u0111\\u1ea1t = t\\u1ed5ng qty - t\\u1ed5ng qty_ok\\n    (SUM(t58.qty) - SUM(t58.qty_ok)) as qty_ng,\\n    \\n    -- T\\u00ednh t\\u1ef7 l\\u1ec7 l\\u1ed7i v\\u00e0 l\\u00e0m tr\\u00f2n 2 ch\\u1eef s\\u1ed1 th\\u1eadp ph\\u00e2n\\n    ROUND(\\n        CASE \\n            WHEN SUM(t58.qty) > 0 THEN          -- Ki\\u1ec3m tra chia cho 0\\n                (SUM(t58.qty) - SUM(t58.qty_ok)) / SUM(t58.qty) *100\\n            ELSE 0 \\n        END, \\n        2\\n    ) AS defect_ratio                           -- T\\u1ef7 l\\u1ec7 l\\u1ed7i = (qty - qty_ok) / qty\\n\\nFROM T58_InLineData t58\\nLEFT JOIN T59_TransInLine t59 ON (\\n    t58.item_id = t59.item_id                   -- Join theo item_id (m\\u00e3 s\\u1ea3n ph\\u1ea9m)\\n    AND t58.process_no = t59.process_id         -- Join theo process_no t\\u1eeb T58 v\\u1edbi process_id t\\u1eeb T59\\n)\\nWHERE \\n    t58.date >= CURDATE() - INTERVAL 1 DAY     -- L\\u1ecdc d\\u1eef li\\u1ec7u trong 14 ng\\u00e0y g\\u1ea7n nh\\u1ea5t\\n    AND t58.date < CURDATE()                    -- Kh\\u00f4ng bao g\\u1ed3m ng\\u00e0y hi\\u1ec7n t\\u1ea1i (ch\\u1ec9 l\\u1ea5y d\\u1eef li\\u1ec7u \\u0111\\u00e3 ho\\u00e0n th\\u00e0nh)\\n    AND t58.qty IS NOT NULL                     -- Lo\\u1ea1i b\\u1ecf c\\u00e1c b\\u1ea3n ghi kh\\u00f4ng c\\u00f3 d\\u1eef li\\u1ec7u qty\\n    AND t58.qty > 0                             -- Ch\\u1ec9 l\\u1ea5y c\\u00e1c b\\u1ea3n ghi c\\u00f3 qty > 0 (c\\u00f3 d\\u1eef li\\u1ec7u th\\u1ef1c t\\u1ebf)\\n\\nGROUP BY \\n    t58.line,                                   -- Nh\\u00f3m theo d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n    DATE(t58.date),                             -- Nh\\u00f3m theo ng\\u00e0y s\\u1ea3n xu\\u1ea5t (b\\u1ecf qua gi\\u1edd)\\n    -- t58.process_no,                             -- Nh\\u00f3m theo m\\u00e3 quy tr\\u00ecnh s\\u1ea3n xu\\u1ea5t\\n    t59.process_viet,                           -- Nh\\u00f3m theo t\\u00ean quy tr\\u00ecnh ti\\u1ebfng Vi\\u1ec7t\\n    -- t59.process_jpn                             -- Nh\\u00f3m theo t\\u00ean quy tr\\u00ecnh ti\\u1ebfng Nh\\u1eadt\\n\\nORDER BY \\n    t58.line,                                   -- S\\u1eafp x\\u1ebfp theo m\\u00e3 d\\u00e2y chuy\\u1ec1n\\n    production_date DESC,                       -- Sau \\u0111\\u00f3 theo ng\\u00e0y gi\\u1ea3m d\\u1ea7n (m\\u1edbi nh\\u1ea5t tr\\u01b0\\u1edbc)\\n    t58.process_no                              -- Cu\\u1ed1i c\\u00f9ng theo m\\u00e3 quy tr\\u00ecnh\\n\\n-- Gi\\u1ea3i th\\u00edch c\\u00e1c tr\\u01b0\\u1eddng k\\u1ebft qu\\u1ea3:\\n-- line: M\\u00e3 \\u0111\\u1ecbnh danh c\\u1ee7a d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n-- production_date: Ng\\u00e0y s\\u1ea3n xu\\u1ea5t (\\u0111\\u1ecbnh d\\u1ea1ng YYYY-MM-DD)\\n-- process_no: M\\u00e3 s\\u1ed1 quy tr\\u00ecnh s\\u1ea3n xu\\u1ea5t trong d\\u00e2y chuy\\u1ec1n\\n-- process_viet: T\\u00ean m\\u00f4 t\\u1ea3 quy tr\\u00ecnh b\\u1eb1ng ti\\u1ebfng Vi\\u1ec7t (l\\u1ea5y t\\u1eeb b\\u1ea3ng T59_TransInLine)\\n-- process_jpn: T\\u00ean m\\u00f4 t\\u1ea3 quy tr\\u00ecnh b\\u1eb1ng ti\\u1ebfng Nh\\u1eadt (l\\u1ea5y t\\u1eeb b\\u1ea3ng T59_TransInLine)\\n-- total_qty: T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u01b0\\u1ee3c ki\\u1ec3m tra trong ng\\u00e0y t\\u1ea1i quy tr\\u00ecnh \\u0111\\u00f3\\n-- total_qty_ok: T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u1ea1t ch\\u1ea5t l\\u01b0\\u1ee3ng trong ng\\u00e0y t\\u1ea1i quy tr\\u00ecnh \\u0111\\u00f3\\n-- qty_ng: T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m kh\\u00f4ng \\u0111\\u1ea1t ch\\u1ea5t l\\u01b0\\u1ee3ng (qty_ng = total_qty - total_qty_ok)\\n-- defect_ratio: T\\u1ef7 l\\u1ec7 l\\u1ed7i (0.00 = 0%, 1.00 = 100%), gi\\u00e1 tr\\u1ecb c\\u00e0ng th\\u1ea5p c\\u00e0ng t\\u1ed1t\\n\\n-- L\\u01b0u \\u00fd v\\u1ec1 JOIN:\\n-- S\\u1eed d\\u1ee5ng LEFT JOIN \\u0111\\u1ec3 \\u0111\\u1ea3m b\\u1ea3o kh\\u00f4ng m\\u1ea5t d\\u1eef li\\u1ec7u t\\u1eeb T58_InLineData \\n-- ngay c\\u1ea3 khi kh\\u00f4ng t\\u00ecm th\\u1ea5y th\\u00f4ng tin m\\u00f4 t\\u1ea3 trong T59_TransInLine\\n-- \\u0110i\\u1ec1u ki\\u1ec7n JOIN: t58.item_id = t59.item_id AND t58.process_no = t59.process_id\",\n  \"type\": \"sql\"\n }\n]",
    "linked_queries": "[]",
    "old_name": null,
    "doctype": "Insights Query v3",
    "variables": [],
    "read_only": false
  },
  {
    "name": "5bs1bl81rk",
    "docstatus": 0,
    "title": null,
    "workbook": "12",
    "use_live_connection": 1,
    "is_script_query": 0,
    "is_builder_query": 0,
    "is_native_query": 0,
    "operations": "[\n {\n  \"table\": {\n   \"query_name\": \"45rcvmvahj\",\n   \"type\": \"query\",\n   \"workbook\": \"\"\n  },\n  \"type\": \"source\"\n },\n {\n  \"filters\": [\n   {\n    \"column\": {\n     \"column_name\": \"line\",\n     \"type\": \"column\"\n    },\n    \"operator\": \"=\",\n    \"value\": 1\n   }\n  ],\n  \"logical_operator\": \"And\",\n  \"type\": \"filter_group\"\n },\n {\n  \"dimensions\": [\n   {\n    \"column_name\": \"production_date\",\n    \"data_type\": \"String\",\n    \"dimension_name\": \"production_date\",\n    \"granularity\": \"day\",\n    \"label\": \"production_date\",\n    \"value\": \"production_date\"\n   }\n  ],\n  \"measures\": [\n   {\n    \"aggregation\": \"sum\",\n    \"column_name\": \"total_qty_ok\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"S\\u1ed1 l\\u01b0\\u1ee3ng \\u0111\\u1ea1t\"\n   },\n   {\n    \"aggregation\": \"sum\",\n    \"column_name\": \"total_qty_ng\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"S\\u1ed1 l\\u01b0\\u1ee3ng l\\u1ed7i\"\n   },\n   {\n    \"aggregation\": \"avg\",\n    \"column_name\": \"defect_ratio\",\n    \"data_type\": \"Decimal\",\n    \"measure_name\": \"T\\u1ec9 l\\u1ec7 l\\u1ed7i\"\n   }\n  ],\n  \"type\": \"summarize\"\n },\n {\n  \"limit\": 100,\n  \"type\": \"limit\"\n }\n]",
    "linked_queries": "[\n \"45rcvmvahj\"\n]",
    "old_name": null,
    "doctype": "Insights Query v3",
    "variables": [],
    "read_only": false
  },
  {
    "name": "45rcvmvahj",
    "docstatus": 0,
    "title": "T58_InLineData_sum_by_date",
    "workbook": "12",
    "use_live_connection": 1,
    "is_script_query": 0,
    "is_builder_query": 0,
    "is_native_query": 1,
    "operations": "[\n {\n  \"data_source\": \"Site DB\",\n  \"raw_sql\": \"SELECT \\n    line,                              -- M\\u00e3 d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n    DATE(date) as production_date,     -- Ng\\u00e0y s\\u1ea3n xu\\u1ea5t (ch\\u1ec9 l\\u1ea5y ph\\u1ea7n date, b\\u1ecf time)\\n    SUM(qty) as total_qty,             -- T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u01b0\\u1ee3c ki\\u1ec3m tra\\n    SUM(qty_ok) as total_qty_ok,       -- T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u1ea1t ch\\u1ea5t l\\u01b0\\u1ee3ng\\n    SUM(qty) - SUM(qty_ok) as total_qty_ng,\\n    ROUND(                             -- T\\u00ednh t\\u1ef7 l\\u1ec7 l\\u1ed7i v\\u00e0 l\\u00e0m tr\\u00f2n 2 ch\\u1eef s\\u1ed1 th\\u1eadp ph\\u00e2n\\n        CASE \\n            WHEN SUM(qty) > 0 THEN     -- Ki\\u1ec3m tra chia cho 0\\n                (SUM(qty) - SUM(qty_ok)) / SUM(qty) *100\\n            ELSE 0 \\n        END, \\n        2\\n    ) AS defect_ratio                  -- T\\u1ef7 l\\u1ec7 l\\u1ed7i = (qty - qty_ok) / qty\\nFROM T58_InLineData\\nWHERE \\n    date >= CURDATE() - INTERVAL 14 DAY  -- L\\u1ecdc d\\u1eef li\\u1ec7u trong 14 ng\\u00e0y g\\u1ea7n nh\\u1ea5t\\n    AND date < CURDATE()                 -- Kh\\u00f4ng bao g\\u1ed3m ng\\u00e0y hi\\u1ec7n t\\u1ea1i (ch\\u1ec9 l\\u1ea5y d\\u1eef li\\u1ec7u \\u0111\\u00e3 ho\\u00e0n th\\u00e0nh)\\n    AND qty IS NOT NULL                  -- Lo\\u1ea1i b\\u1ecf c\\u00e1c b\\u1ea3n ghi kh\\u00f4ng c\\u00f3 d\\u1eef li\\u1ec7u qty\\n    AND qty > 0                          -- Ch\\u1ec9 l\\u1ea5y c\\u00e1c b\\u1ea3n ghi c\\u00f3 qty > 0\\nGROUP BY \\n    line,                                -- Nh\\u00f3m theo d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n    DATE(date)                           -- Nh\\u00f3m theo ng\\u00e0y (b\\u1ecf qua gi\\u1edd)\\nORDER BY \\n    line,                                -- S\\u1eafp x\\u1ebfp theo m\\u00e3 d\\u00e2y chuy\\u1ec1n\\n    production_date DESC                 -- Sau \\u0111\\u00f3 s\\u1eafp x\\u1ebfp theo ng\\u00e0y gi\\u1ea3m d\\u1ea7n (m\\u1edbi nh\\u1ea5t tr\\u01b0\\u1edbc)\\n\\n-- Gi\\u1ea3i th\\u00edch c\\u00e1c tr\\u01b0\\u1eddng k\\u1ebft qu\\u1ea3:\\n-- line: M\\u00e3 \\u0111\\u1ecbnh danh c\\u1ee7a d\\u00e2y chuy\\u1ec1n s\\u1ea3n xu\\u1ea5t\\n-- production_date: Ng\\u00e0y s\\u1ea3n xu\\u1ea5t (\\u0111\\u1ecbnh d\\u1ea1ng YYYY-MM-DD)\\n-- total_qty: T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u01b0\\u1ee3c ki\\u1ec3m tra trong ng\\u00e0y t\\u1ea1i d\\u00e2y chuy\\u1ec1n \\u0111\\u00f3\\n-- total_qty_ok: T\\u1ed5ng s\\u1ed1 l\\u01b0\\u1ee3ng s\\u1ea3n ph\\u1ea9m \\u0111\\u1ea1t ch\\u1ea5t l\\u01b0\\u1ee3ng trong ng\\u00e0y t\\u1ea1i d\\u00e2y chuy\\u1ec1n \\u0111\\u00f3  \\n-- defect_ratio: T\\u1ef7 l\\u1ec7 l\\u1ed7i (0.00 = 0%, 1.00 = 100%), gi\\u00e1 tr\\u1ecb c\\u00e0ng th\\u1ea5p c\\u00e0ng t\\u1ed1t\",\n  \"type\": \"sql\"\n }\n]",
    "linked_queries": "[]",
    "old_name": null,
    "doctype": "Insights Query v3",
    "variables": [],
    "read_only": false
  }
]